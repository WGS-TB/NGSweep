<tool id="parse_refseq_masher" name="Parse refseq_masher output" version="0.1.0">
    <description>and output a list of outliers</description>
    <command><![CDATA[
        $__tool_directory__/refseq_parser -r $reference -i #for $report in $reports# $report #end for#
    ]]></command>
    <inputs>
        <param name="reports" type="data" format="tabular" label="Refseq_masher report" help="" optional="false" multiple="True" />
        <param name="reference" type="data" format="fasta" label="FASTA reference genome" help="" optional="false" />
    </inputs>
    <outputs>
        <data name="output_file" label="Outliers from dataset" format="tabular"/>
    </outputs>

    <tests>
        <test>
            <param name="reference" value="reference.fna.gz" ftype="fasta" />
            <param name="report" value="test.tsv" ftype="tabular" />
            <output name="output" value="output.tsv" ftype="tabular" />
        </test>
    </tests>

    <help><![CDATA[
        Parses refseq_masher output and returns a list of outliers based on two criteria:

        1. If the mash match is not the same organism as the reference genome
        2. If the distance between the match and the sample is >0.05

        Command line:
        refseq_parser -r <reference FASTA> -i <mash_output.tsv>
    ]]></help>

    <citations>
        Manuscript in preparation
    </citations>
</tool>
